Sub getNumber()
    Dim cn As Object, rs As Object, output As String, sql As String
    
    Dim b As Integer
    
    Dim testString As String
    testColor = "{W}"
    testRarity = "2"
    
    '---Connecting to the Data Source---
    Set cn = CreateObject("ADODB.Connection")
    With cn
        .Provider = "Microsoft.ACE.OLEDB.12.0"
        .ConnectionString = "Data Source=" & ThisWorkbook.Path & "\" & ThisWorkbook.Name & ";" & _
        "Extended Properties=""Excel 12.0 Xml;HDR=YES"";"
        .Open
    End With
    
    
     '---Run the SQL SELECT Query---
    sql = "SELECT COUNT(*) FROM [Sheet1$] Where [Rarity2] > " & testRarity & " AND [COLOR_IDENTITY]='" & testColor & "'"
    Set rs = cn.Execute(sql)
    
    Do
       output = output & rs(0) '& ";" & rs(1) & ";" & rs(2) & vbNewLine
       'Debug.Print rs(0); '";" & rs(1) & ";" & rs(2)
        b = rs(0)
       rs.Movenext
    Loop Until rs.EOF
    MsgBox output
    
    
    '---Clean up---
    rs.Close
    cn.Close
    Set cn = Nothing
    Set rs = Nothing
    
'    RunSELECT = b
End Sub





